<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>漳平一中头像生成器</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=0">
    <style>
        .p-info {
            border: khaki 1px solid;
            background-color: #fff9cb;
            padding: 10px;
        }
    </style>
</head>
<body style="text-align: center;">
<div id="origin" style="position: relative;display:inline-block;width:300px;height:300px;">
    <div style="position:absolute;">
        <img src="border.png" width="300" height="300"/>
    </div>
    <img id="img_origin" src="tip.png" width="200" height="200" style="padding-top: 50px"/>
</div>
<input type="file" name="file" id="file" style="display:none;"/>
<div id="show" style="display: none;text-align: center;">
    <img id="img_result" width="300" height="300"/>
    <p class="p-info"><a id="download" download="avatar.png">点击保存头像</a></p>
    <p class="p-info"><a href="javascript:redo()">重做</a></p>
</div>
<p class="p-info">微博里面无法保存图片，请点击右上角浏览器打开；微信/QQ内请长按头像保存到本地；</p>
<p class="p-info"><a href="101.html">国庆五星红旗版</a></p>
<script src="https://html2canvas.hertzen.com/dist/html2canvas.js"></script>
<script>
    let div_origin = document.getElementById("origin");
    let div_show = document.getElementById("show");
    let img_origin = document.getElementById("img_origin");
    let img_result = document.getElementById("img_result");
    let a_download = document.getElementById('download');

    document.getElementById("file").addEventListener("change", function () {
        let file = this.files[0];
        let reader = new FileReader();
        reader.onload = function () {
            img_origin.src = this.result;
            html2canvas(div_origin).then(function (canvas) {
                img_result.setAttribute("crossOrigin", 'Anonymous');
                img_result.src = canvas.toDataURL("image/png");
                a_download.href = canvas.toDataURL("image/png");
                div_show.style.display = 'block';
                div_origin.style.display = 'none';
            });
        };
        reader.readAsDataURL(file);
    });
    div_origin.addEventListener("click", function () {
        document.getElementById("file").click();
    });

    function redo() {
        div_show.style.display = 'none';
        div_origin.style.display = 'inline-block';
        img_origin.src = 'tip.png';
    }
</script>
<div style="position: fixed;bottom: 25px;">
    <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
    document.write(unescape("%3Cspan id='cnzz_stat_icon_1278057974'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/stat.php%3Fid%3D1278057974%26online%3D2' type='text/javascript'%3E%3C/script%3E"));</script>
</div>
</body>
</html>
